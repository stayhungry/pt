<div>

	<!-- dependencies -->
	<script type="text/javascript" src="fup/mustache-0.3.0.js"></script>
	<script type="text/javascript" src="fup/modernizr.custom.js"></script>

	<script type="text/javascript" src="fup/nysi.core.js"></script>
	<script type="text/javascript" src="fup/nysi.conf.js"></script>
	<link type="text/css" rel="stylesheet" href="fup/nysi.core.css" />

	<!-- main logic -->
	<script type="text/javascript">

		var myApp = function(){
			var that = NYSI.framework.app();
			that.init = function init(){
		  	pathToUpload = "http://mylaptop/pt/filewgt/fup.php"

				$(function(){
					NYSI.util.loadAppRes(that, {
						'test': 	!!window.FileReader && Modernizr.draganddrop, 
						'modern': {
							resources: ['fup/html5/nysi.html5.css', 'fup/html5/nysi.html5.js']
						},
						'legacy' : {
							resources: ['fup/flash/swfobject.js', 'fup/flash/jquery.uploadify.v2.1.4.min.js', 'fup/flash/uploadify.css', 'fup/flash/nysi.flash.js']
						}
					});
				});
			}
			
			that.initModern = function initModern(){
				$('#html5-impl').show();
				$('#flash-impl').hide();
				var nysiFileUpload = NYSI.html5.filemgr.bootstrap();	
				$('#file-to-upload').bind({
					change: function(e) {
						nysiFileUpload.showFiles();
						$('#btn-upload').show();
						e.preventDefault();
					}
				});
				$('#btn-select').bind({
					click: function(e) {
						$('#file-to-upload').click();
					}
				});
				$('#btn-upload').bind({
					click: function(e) {
						nysiFileUpload.uploadFiles();
					}
				});
			}
			
			that.initLegacy = function initLegacy(){
				$('#flash-impl').show();
				$('#html5-impl').hide();
				NYSI.flash.filemgr.bootstrap();
				$('#btn_upload').bind({
					click: function(e) {
						$('#file_upload').uploadifyUpload();
					}
				});
			}

			return that;

		}()
		
		NYSI.framework.jQueryBootStrap(myApp);
	</script>

	<!-- mustache templates -->
	<script id="tpl-file-list" type="x-tmpl-mustache">
	
		<ul>
	    {{#files}}
	    <li>
				<div>{{fileName}} ({{fileSize}}) ({{fileType}})</div>
				<div class="progress-bar-container">
					<div id="progress-bar-{{fileId}}" class="progress-bar">
					</div>
					<div id="upload-response-{{fileId}}"></div>
				</div>
			</li>
	    {{/files}}
	  </ul>
	
	</script>
	

	<!-- html5 structure -->
	<div id="html5-impl" class="hidden"> 
		<form id="fup-form">
		    <input type="file" id="file-to-upload" class="hidden" multiple/>
		    <input type="button" id="btn-select" value="UPLOAD FILES" />
		</form>
		<div id="file-list"></div>
	  <input type="button" id="btn-upload" value="Upload" class="hidden"/>
	</div>
	
	<!-- flash structure -->
	<!-- 3 musts:  client-side:  id="file_upload" and "fileName" can't be used as selector id;  server-side: $file_id='Filedata' -->
	<div id="flash-impl" class="hidden"> 
		<input type="file" id="file_upload" />
		<input type="button" id="btn_upload" value="Upload" class="hidden" />
	</div>

</div>
